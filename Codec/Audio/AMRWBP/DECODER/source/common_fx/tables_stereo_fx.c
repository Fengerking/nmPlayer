/* Tables used by stereo modes */

#include "amr_plus_fx.h"

const Word16 StereoNbits_FX[] = {
  (Word16)(1.2*80),  /* 1.2 + 0.8 = 2.0 kbps */
  (Word16)(1.6*80),  /* 1.6 + 0.8 = 2.4 kbps */
  (Word16)(2.0*80),  /* 2.0 + 0.8 = 2.8 kbps */
  (Word16)(2.4*80),  /* 2.4 + 0.8 = 3.2 kbps */
  (Word16)(2.8*80),  /* 2.8 + 0.8 = 3.6 kbps */
  (Word16)(3.2*80),  /* 3.2 + 0.8 = 4.0 kbps */
  (Word16)(3.6*80),  /* 3.6 + 0.8 = 4.4 kbps */
  (Word16)(4.0*80),  /* 4.0 + 0.8 = 4.8 kbps */
  (Word16)(4.4*80),  /* 4.4 + 0.8 = 5.2 kbps */
  (Word16)(4.8*80),  /* 4.8 + 0.8 = 5.6 kbps */
  (Word16)(5.2*80),  /* 5.2 + 0.8 = 6.0 kbps */
  (Word16)(5.6*80),  /* 5.6 + 0.8 = 6.4 kbps */
  (Word16)(6.0*80),  /* 6.0 + 0.8 = 6.8 kbps */
  (Word16)(6.4*80),  /* 6.4 + 0.8 = 7.2 kbps */
  (Word16)(6.8*80),  /* 6.8 + 0.8 = 7.6 kbps */
  (Word16)(7.2*80)}; /* 7.2 + 0.8 = 8.0 kbps */
const Word16 *StereoNbits = StereoNbits_FX;


///////////////////////////////////////////////
// OVERALL DELAY = L_FILTER_2K *2 in the oversampled domain  
const Word16 Filter_2k_fxQ14_32[321] = {
     15565,     15542,     15473,     15358,     15198,     14994,     14747,     14457,
     14129,     13761,     13357,     12919,     12449,     11950,     11424,     10875,
     10304,      9716,      9112,      8496,      7872,      7242,      6610,      5978,
      5350,      4728,      4116,      3516,      2931,      2363,      1815,      1289,
       786,       310,      -139,      -559,      -948,     -1307,     -1634,     -1928,
     -2189,     -2417,     -2612,     -2774,     -2904,     -3001,     -3068,     -3105,
     -3113,     -3094,     -3048,     -2978,     -2886,     -2772,     -2639,     -2489,
     -2324,     -2145,     -1956,     -1756,     -1551,     -1340,     -1126,      -910,
      -696,      -483,      -275,       -73,       122,       309,       485,       651,
       805,       946,      1073,      1186,      1285,      1369,      1438,      1491,
      1530,      1553,      1562,      1558,      1539,      1508,      1464,      1409,
      1344,      1269,      1186,      1095,       998,       895,       787,       677,
       565,       451,       337,       224,       114,         6,       -99,      -199,
      -294,      -383,      -465,      -541,      -609,      -670,      -722,      -767,
      -803,      -831,      -850,      -861,      -865,      -860,      -848,      -829,
      -804,      -772,      -734,      -691,      -644,      -592,      -537,      -479,
      -419,      -357,      -294,      -231,      -168,      -105,       -44,        15,
        73,       127,       179,       227,       271,       312,       348,       380,
       407,       430,       448,       461,       470,       474,       474,       470,
       462,       450,       434,       415,       393,       368,       341,       312,
       281,       249,       216,       182,       148,       113,        79,        46,
        14,       -18,       -48,       -77,      -103,      -128,      -150,      -171,
      -189,      -204,      -218,      -228,      -236,      -242,      -245,      -246,
      -245,      -242,      -236,      -229,      -220,      -209,      -197,      -183,
      -169,      -153,      -137,      -120,      -103,       -85,       -68,       -51,
       -34,       -18,        -2,        14,        28,        41,        55,        66,
        76,        85,        93,       100,       106,       110,       113,       115,
       116,       116,       115,       112,       109,       105,       100,        94,
        89,        82,        74,        67,        59,        52,        44,        36,
        28,        20,        13,         5,        -2,        -8,       -14,       -20,
       -25,       -29,       -34,       -37,       -40,       -43,       -45,       -46,
       -47,       -48,       -48,       -47,       -46,       -45,       -43,       -41,
       -39,       -36,       -34,       -31,       -28,       -25,       -22,       -19,
       -16,       -13,        -9,        -7,        -4,        -1,         1,         4,
         6,         7,         9,        11,        12,        13,        14,        15,
        15,        16,        16,        16,        15,        15,        15,        14,
        13,        13,        10,        11,        10,         9,         8,         7,
         6,         5,         4,         3,         2,         2,         1,         0,
        -1,        -1,        -2,        -2,        -3,        -3,        -3,        -3,
        -3,        -3,        -3,        -3,        -3,        -3,        -3,        -3,
          0};
const Word16 Filter_2k_fxQ14_5[321] = {
      2432,      2428,      2418,      2400,      2375,      2343,      2304,      2259,
      2208,      2150,      2087,      2019,      1945,      1867,      1785,      1699,
      1610,      1518,      1424,      1328,      1230,      1132,      1033,       934,
       836,       739,       643,       549,       458,       369,       284,       201,
       123,        48,       -22,       -87,      -148,      -204,      -255,      -301,
      -342,      -378,      -408,      -433,      -454,      -469,      -479,      -485,
      -486,      -483,      -476,      -465,      -451,      -433,      -412,      -389,
      -363,      -335,      -306,      -274,      -242,      -209,      -176,      -142,
      -109,       -76,       -43,       -11,        19,        48,        76,       102,
       126,       148,       168,       185,       201,       214,       225,       233,
       239,       243,       244,       243,       241,       236,       229,       220,
       210,       198,       185,       171,       156,       140,       123,       106,
        88,        70,        53,        35,        18,         1,       -15,       -31,
       -46,       -60,       -73,       -85,       -95,      -105,      -113,      -120,
      -126,      -130,      -133,      -135,      -135,      -134,      -133,      -130,
      -126,      -121,      -115,      -108,      -101,       -92,       -84,       -75,
       -65,       -56,       -46,       -36,       -26,       -16,        -7,         2,
        11,        20,        28,        35,        42,        49,        54,        59,
        64,        67,        70,        72,        73,        74,        74,        73,
        72,        70,        68,        65,        61,        58,        53,        49,
        44,        39,        34,        28,        23,        18,        12,         7,
         2,        -3,        -8,       -12,       -16,       -20,       -24,       -27,
       -29,       -32,       -34,       -36,       -37,       -38,       -38,       -39,
       -38,       -38,       -37,       -36,       -34,       -33,       -31,       -29,
       -26,       -24,       -21,       -19,       -16,       -13,       -11,        -8,
        -5,        -3,         0,         2,         4,         6,         9,        10,
        12,        13,        15,        16,        17,        17,        18,        18,
        18,        18,        18,        18,        17,        16,        16,        15,
        14,        13,        12,        10,         9,         8,         7,         6,
         4,         3,         2,         1,         0,        -1,        -2,        -3,
        -4,        -5,        -5,        -6,        -6,        -7,        -7,        -7,
        -7,        -7,        -7,        -7,        -7,        -7,        -7,        -6,
        -6,        -6,        -5,        -5,        -4,        -4,        -3,        -3,
        -2,        -2,        -1,        -1,        -1,         0,         0,         1,
         1,         1,         1,         2,         2,         2,         2,         2,
         2,         2,         2,         2,         2,         2,         2,         2,
         2,         2,         2,         2,         2,         1,         1,         1,
         1,         1,         1,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,
          0};



// average filter
const Word16 cb_filt_hi_mean_fx[HI_FILT_ORDER] = 
// Q14
{  +244,    -25,    +23,     +6,    -83,    -66,    -37,    -33,    -23 };

const Word16 filt_hi_mscb_4a_fx[SIZE_FILT_HI_MSVQ_4A][HI_FILT_ORDER] = {
// Q14
{   +895,   +272,  +1117,  +1273,   +557,   -317,   -928,  -1095,  -1770 },
{  +1418,   +165,   -243,   -253,   -308,   -233,   -195,   -171,   -173 },
{  -5448, +13249,   +404,  -1666,  -2496,  +1049, +10237, -26321, +10996 },
{  -5007,  +1041,   +520,   +429,   +600,   +527,   +469,   +488,   +935 },
{  +1486,  -2493,   +373,   -216,   +496,    +75,   +189,     +2,    +90 },
{  -1989,  +2030,  +2883,   +112,  -1532,   -139,   +202,   -581,   -980 },
{  -2179,   -517,   +264,   +367,   +570,   +525,   +462,   +283,   +228 },
{  +4581,   +142,   -971,  -1008,   -429,   -474,   -533,   -374,   -928 },
{  +4524,   +341,  +3025,  -5001,  -2637,  +2680,  -7417,   +725,  +3764 },
{  -1016,  +1915,   -892,    +31,    -19,    +68,   -136,   +284,   -229 },
{  +9681,  -3898,  -3037,  +7821, -10376,  -5459,  +6488,  -3499,  +2286 },
{   -249,    -86,   +111,    -73,    +99,    +87,   +111,    +60,    -56 },
{  +2500,  -4908,   -474,  +3008,  -2706,  +2727,  -1546,  +2049,   -645 },
{  +5449, -13248,   -403,  +1667,  +2497,  -1048, -10236, +26322, -10995 },
{   -337,   -539,   -597,   -418,   -301,   -408,    +23,   +373,  +2211 },
{  +1958,  +4419,  +1053,  +2608,  +2195,  -7306,   +218,  -4166,   -975 }
};

const Word16 filt_hi_mscb_7a_fx[SIZE_FILT_HI_MSVQ_7A][HI_FILT_ORDER] = {
// Q14
{  -1214,   +491,   -168,   -903,   -955,   +299,  +1285,  -1862,  +3031 },
{   +866,  +1956,  +1013,   -860,  -1236,    +19,   -192,  -2933,  +1372 },
{  +8062,   +219,  -4882,  +4795,  -3626,  -6690,  +5009,  -1762,  -1121 },
{   -938,  +3170,  -1298,   +507,   -877,  +1006,   +351,  -2404,   +487 },
{   -258,  +1295,  +1248,   +641,   +289,  +1023,   +304,  -3876,   -665 },
{  -1562,  +1639,   +342,   -379,    -71,   +870,   +965,  -2731,   +931 },
{  -6364,  +1128,  +1245,   +757,   +707,  +1646,  +1377,  -2274,  +1779 },
{   +927,  +3877,  +1173,  +1797,  +1182,  -3900,   +514,  -5214,   -352 },
{   +534,   -646,   +927,  -1022,   +423,   +520,   +887,  -2645,  +1025 },
{  -3011,  +3447,  +1908,   -388,  -1594,   +627,  +1530,  -2661,   +146 },
{   -450,   +466,   -338,   +679,   +270,   +265,   +322,  -3257,  +2048 },
{   +297,  +1178,    -58,   -547,   -506,   +848,  +1087,  -2848,   +553 },
{  +3899,  +1178,   -734,   -889,   -740,   +117,   +196,  -3251,   +229 },
{  -8061,   -218,  +4883,  -4794,  +3627,  +6691,  -5008,  +1763,  +1122 },
{  +2041,  -3697,   +860,  +2187,  -2055,  +2131,   -488,  -1207,   +232 },
{  -2850,  +1465,   +328,   -229,   +223,  +1049,  +1193,  -2511,  +1335 }
};

const Word16 filt_hi_mscb_7b_fx[SIZE_FILT_HI_MSVQ_7B][HI_FILT_ORDER] = {
// Q14
{   +651,   -373,   -191,    -74,   +939,   -926,   -898,  +3846,  -2969 },
{  +2141,  -1729,   -347,   +310,    +14,   -917,  -1052,  +2635,  -1050 },
{   +535,  -2556,   +656,   +753,    +35,   -745,   -323,  +2696,  -1047 },
{   -900,   -632,   +158,   +518,   +481,   -772,  -1039,  +2841,   -650 },
{  -3505,  +8828,   +996,   +222,  -2657,  +2960,  +6492, -19781,  +6448 },
{   +937,   +182,   -917,   -236,     +8,  -1045,   -627,  +2406,   -702 },
{   +838,  -1545,  +1027,  -1810,   +266,  +1105,  -2627,  +2112,   +637 },
{   -694,  -2168,  -1377,   +319,   +916,   +346,    +79,  +3245,   -661 }
};
// gain quantizers

// average gain vector
const Word16 cb_gain_hi_mean_fx[HI_GAIN_ORDER] = {   
// Q10
	+1185, +1185
};

const Word16 gain_hi_mscb_2a_fx[SIZE_GAIN_HI_MSVQ_2A][HI_GAIN_ORDER] = {
// Q10
{   +269,   +835 },
{  -1141,  +2629 },
{   -436,   -569 },
{  +1668,   -155 }
};

const Word16 gain_hi_mscb_5a_fx[SIZE_GAIN_HI_MSVQ_5A][HI_GAIN_ORDER] = {
// Q10
{   -670,  +3804 },
{   -177,  -6256 },
{  +3297,   -605 },
{  -2166,    +60 },
{   -197, -12136 },
{   -432,    -19 },
{  +1466,   +283 },
{   +435,   +808 },
{   -980,  +1159 },
{   +216,  -1316 },
{   -566,   -524 },
{  -7958,   -166 },
{  +1074, -24779 },
{   +496,   -508 },
{   +797,   +183 },
{   -129,  +1325 },
{   -963,   +314 },
{   +165,   +131 },
{    -73,   -413 },
{  +1131,   +941 },
{  +2212,    -19 },
{ -18715,   -282 },
{   +541,  +1628 },
{   -165,  -3318 },
{  +5565,  -1041 },
{  +1293,   -623 },
{   -223,   -869 },
{   -669,  +7380 },
{  -1249,  -1333 },
{   -918,   -217 },
{   -269,   +599 },
{   -284,  +2335 }
};





const Word16 size_filt_hi_msvq_4_fx[NSTAGES_FILT_HI_MSVQ4] = {SIZE_FILT_HI_MSVQ_4A};
const Word16 *cbs_filt_hi_msvq_4_fx[NSTAGES_FILT_HI_MSVQ4] = {(const Word16 *)filt_hi_mscb_4a_fx};
const PMSVQ_fx filt_hi_pmsvq4_fx={ 
	16384,  // 0.5 in Q15
	16384,  // 0.5 in Q15
	cb_filt_hi_mean_fx,
	{	HI_FILT_ORDER,
		NSTAGES_FILT_HI_MSVQ4, 
		INTENS_FILT_HI_MSVQ4, 
		size_filt_hi_msvq_4_fx,
		cbs_filt_hi_msvq_4_fx
	}
};

// 4+3 bit msvq (filter)
const Word16 size_filt_hi_msvq_7_fx[NSTAGES_FILT_HI_MSVQ7] = {SIZE_FILT_HI_MSVQ_7A, SIZE_FILT_HI_MSVQ_7B};
const Word16 *cbs_filt_hi_msvq_7_fx[NSTAGES_FILT_HI_MSVQ7] = {(const Word16 *)filt_hi_mscb_7a_fx, (const Word16 *)filt_hi_mscb_7b_fx};
const PMSVQ_fx filt_hi_pmsvq7_fx={ 
	16384,  // 0.5 in Q15
	16384,  // 0.5 in Q15
	cb_filt_hi_mean_fx,
	{	HI_FILT_ORDER,
		NSTAGES_FILT_HI_MSVQ7, 
		INTENS_FILT_HI_MSVQ7, 
		size_filt_hi_msvq_7_fx,
		cbs_filt_hi_msvq_7_fx
	}
};

// 2 bit VQ (gain)
const Word16 size_gain_hi_msvq_2_fx[NSTAGES_GAIN_HI_MSVQ2] = {SIZE_GAIN_HI_MSVQ_2A};
const Word16 *cbs_gain_hi_msvq_2_fx[NSTAGES_GAIN_HI_MSVQ2] = {(const Word16 *)gain_hi_mscb_2a_fx};
const PMSVQ_fx gain_hi_pmsvq2_fx={ 
	16384,  // 0.5 in Q15
	16384,  // 0.5 in Q15
	cb_gain_hi_mean_fx,
	{	HI_GAIN_ORDER,
		NSTAGES_GAIN_HI_MSVQ2, 
		INTENS_GAIN_HI_MSVQ2, 
		size_gain_hi_msvq_2_fx,
		cbs_gain_hi_msvq_2_fx
	}
};
// 5 bit VQ (gain)
const Word16 size_gain_hi_msvq_5_fx[NSTAGES_GAIN_HI_MSVQ5] = {SIZE_GAIN_HI_MSVQ_5A};
const Word16 *cbs_gain_hi_msvq_5_fx[NSTAGES_GAIN_HI_MSVQ5] = {(const Word16 *)gain_hi_mscb_5a_fx};
const PMSVQ_fx gain_hi_pmsvq5_fx={ 
	16384,  // 0.5 in Q15
	16384,  // 0.5 in Q15
	cb_gain_hi_mean_fx,
	{	HI_GAIN_ORDER,
		NSTAGES_GAIN_HI_MSVQ5, 
		INTENS_GAIN_HI_MSVQ5, 
		size_gain_hi_msvq_5_fx,
		cbs_gain_hi_msvq_5_fx
	}
};
