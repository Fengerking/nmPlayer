
#include "voResample.h"
/*sin and cos function, Magnifying 0x8000, and need right shift 15 bits, 0x8000 * sin(i * pi / 512), i=0,1,...,256. */
//__declspec(align(4)) VO_U16 sine_table[257] =
VO_U16 sine_table[258] =
{
	0x0,	0xc9,	0x192,	0x25b,	0x324,	0x3ed,	0x4b6,	0x57f,	0x647,	0x710,	0x7d9,	0x8a2,	0x96a,	0xa33,	0xafb,	0xbc3,
	0xc8b,	0xd53,	0xe1b,	0xee3,	0xfab,	0x1072,	0x1139,	0x1201,	0x12c8,	0x138e,	0x1455,	0x151b,	0x15e2,	0x16a8,	0x176d,	0x1833,
	0x18f8,	0x19bd,	0x1a82,	0x1b47,	0x1c0b,	0x1ccf,	0x1d93,	0x1e56,	0x1f19,	0x1fdc,	0x209f,	0x2161,	0x2223,	0x22e5,	0x23a6,	0x2467,
	0x2528,	0x25e8,	0x26a8,	0x2767,	0x2826,	0x28e5,	0x29a3,	0x2a61,	0x2b1f,	0x2bdc,	0x2c98,	0x2d55,	0x2e11,	0x2ecc,	0x2f87,	0x3041,
	0x30fb,	0x31b5,	0x326e,	0x3326,	0x33de,	0x3496,	0x354d,	0x3604,	0x36ba,	0x376f,	0x3824,	0x38d8,	0x398c,	0x3a40,	0x3af2,	0x3ba5,
	0x3c56,	0x3d07,	0x3db8,	0x3e68,	0x3f17,	0x3fc5,	0x4073,	0x4121,	0x41ce,	0x427a,	0x4325,	0x43d0,	0x447a,	0x4524,	0x45cd,	0x4675,
	0x471c,	0x47c3,	0x4869,	0x490f,	0x49b4,	0x4a58,	0x4afb,	0x4b9e,	0x4c3f,	0x4ce1,	0x4d81,	0x4e21,	0x4ebf,	0x4f5e,	0x4ffb,	0x5097,
	0x5133,	0x51ce,	0x5269,	0x5302,	0x539b,	0x5433,	0x54ca,	0x5560,	0x55f5,	0x568a,	0x571d,	0x57b0,	0x5842,	0x58d4,	0x5964,	0x59f3,
	0x5a82,	0x5b10,	0x5b9d,	0x5c29,	0x5cb4,	0x5d3e,	0x5dc7,	0x5e50,	0x5ed7,	0x5f5e,	0x5fe3,	0x6068,	0x60ec,	0x616f,	0x61f1,	0x6271,
	0x62f2,	0x6371,	0x63ef,	0x646c,	0x64e8,	0x6563,	0x65dd,	0x6657,	0x66cf,	0x6746,	0x67bd,	0x6832,	0x68a6,	0x6919,	0x698c,	0x69fd,
	0x6a6d,	0x6adc,	0x6b4a,	0x6bb8,	0x6c24,	0x6c8f,	0x6cf9,	0x6d62,	0x6dca,	0x6e30,	0x6e96,	0x6efb,	0x6f5f,	0x6fc1,	0x7023,	0x7083,
	0x70e2,	0x7141,	0x719e,	0x71fa,	0x7255,	0x72af,	0x7307,	0x735f,	0x73b5,	0x740b,	0x745f,	0x74b2,	0x7504,	0x7555,	0x75a5,	0x75f4,
	0x7641,	0x768e,	0x76d9,	0x7723,	0x776c,	0x77b4,	0x77fa,	0x7840,	0x7884,	0x78c7,	0x7909,	0x794a,	0x798a,	0x79c8,	0x7a05,	0x7a42,
	0x7a7d,	0x7ab6,	0x7aef,	0x7b26,	0x7b5d,	0x7b92,	0x7bc5,	0x7bf8,	0x7c29,	0x7c5a,	0x7c89,	0x7cb7,	0x7ce3,	0x7d0f,	0x7d39,	0x7d62,
	0x7d8a,	0x7db0,	0x7dd6,	0x7dfa,	0x7e1d,	0x7e3f,	0x7e5f,	0x7e7f,	0x7e9d,	0x7eba,	0x7ed5,	0x7ef0,	0x7f09,	0x7f21,	0x7f38,	0x7f4d,
	0x7f62,	0x7f75,	0x7f87,	0x7f97,	0x7fa7,	0x7fb5,	0x7fc2,	0x7fce,	0x7fd8,	0x7fe1,	0x7fe9,	0x7ff0,	0x7ff6,	0x7ffa,	0x7ffd,	0x7fff,
	0x8000, 0x0000
};
/*
   looks up sin(2 * Pi * x / 1024) * 0x8000;
   0x8000 * sin(x) = lookup_sine(x*512/pi)
*/
int lookup_sine(int x)
{
	int xx = x & 0xFF;
	switch ((x>>8) & 0x03)
    {
    default: /* just to shut gcc up. */
    case 0:
		return (int)sine_table[xx];
    case 1:
		return (int)sine_table[0x100 - xx];
    case 2:
		return (int)(-sine_table[xx]);
    case 3:
		return (int)(-sine_table[0x100 - xx]);
    }
}

//VO_S32 GetSample16(VO_U8 *pCurrentPos, VO_S32 iOffset)
//{
//	VO_U16 pSrc = ((VO_U16 *)pCurrentPos) + iOffset;
//	return *pSrc;
//}
#if 0
/* 
for(i=0; i<1024; i++)
		CosTab[i] = (VO_S16)(cos(M_PI * i/1024)*(1<<9) +- 0.5);
*/
VO_S16 CosTab[1025] = 
{
 512, 512, 512, 512, 512, 512, 512, 512, 512, 512, 512, 512, 512, 512, 512, 511,
 511, 511, 511, 511, 511, 511, 511, 511, 511, 510, 510, 510, 510, 510, 510, 510,
 510, 509, 509, 509, 509, 509, 509, 508, 508, 508, 508, 508, 507, 507, 507, 507,
 506, 506, 506, 506, 505, 505, 505, 505, 504, 504, 504, 504, 503, 503, 503, 502,
 502, 502, 502, 501, 501, 501, 500, 500, 500, 499, 499, 499, 498, 498, 497, 497,
 497, 496, 496, 495, 495, 495, 494, 494, 493, 493, 493, 492, 492, 491, 491, 490,
 490, 489, 489, 489, 488, 488, 487, 487, 486, 486, 485, 485, 484, 484, 483, 483,
 482, 482, 481, 480, 480, 479, 479, 478, 478, 477, 477, 476, 475, 475, 474, 474,
 473, 472, 472, 471, 471, 470, 469, 469, 468, 467, 467, 466, 465, 465, 464, 464,
 463, 462, 461, 461, 460, 459, 459, 458, 457, 457, 456, 455, 454, 454, 453, 452,
 452, 451, 450, 449, 449, 448, 447, 446, 445, 445, 444, 443, 442, 442, 441, 440,
 439, 438, 438, 437, 436, 435, 434, 433, 433, 432, 431, 430, 429, 428, 427, 427,
 426, 425, 424, 423, 422, 421, 420, 420, 419, 418, 417, 416, 415, 414, 413, 412,
 411, 410, 409, 408, 407, 407, 406, 405, 404, 403, 402, 401, 400, 399, 398, 397,
 396, 395, 394, 393, 392, 391, 390, 389, 388, 387, 386, 385, 384, 383, 381, 380,
 379, 378, 377, 376, 375, 374, 373, 372, 371, 370, 369, 368, 366, 365, 364, 363,
 362, 361, 360, 359, 358, 356, 355, 354, 353, 352, 351, 350, 348, 347, 346, 345,
 344, 343, 342, 340, 339, 338, 337, 336, 334, 333, 332, 331, 330, 328, 327, 326,
 325, 324, 322, 321, 320, 319, 317, 316, 315, 314, 313, 311, 310, 309, 308, 306,
 305, 304, 302, 301, 300, 299, 297, 296, 295, 294, 292, 291, 290, 288, 287, 286,
 284, 283, 282, 281, 279, 278, 277, 275, 274, 273, 271, 270, 269, 267, 266, 265,
 263, 262, 261, 259, 258, 256, 255, 254, 252, 251, 250, 248, 247, 246, 244, 243,
 241, 240, 239, 237, 236, 234, 233, 232, 230, 229, 227, 226, 225, 223, 222, 220,
 219, 217, 216, 215, 213, 212, 210, 209, 207, 206, 205, 203, 202, 200, 199, 197,
 196, 194, 193, 192, 190, 189, 187, 186, 184, 183, 181, 180, 178, 177, 175, 174,
 172, 171, 170, 168, 167, 165, 164, 162, 161, 159, 158, 156, 155, 153, 152, 150,
 149, 147, 146, 144, 143, 141, 140, 138, 137, 135, 134, 132, 130, 129, 127, 126,
 124, 123, 121, 120, 118, 117, 115, 114, 112, 111, 109, 108, 106, 105, 103, 101,
 100, 98, 97, 95, 94, 92, 91, 89, 88, 86, 84, 83, 81, 80, 78, 77,
 75, 74, 72, 70, 69, 67, 66, 64, 63, 61, 60, 58, 56, 55, 53, 52,
 50, 49, 47, 45, 44, 42, 41, 39, 38, 36, 35, 33, 31, 30, 28, 27,
 25, 24, 22, 20, 19, 17, 16, 14, 13, 11, 9, 8, 6, 5, 3, 2,
 0, -2, -3, -5, -6, -8, -9, -11, -13, -14, -16, -17, -19, -20, -22, -24,
 -25, -27, -28, -30, -31, -33, -35, -36, -38, -39, -41, -42, -44, -45, -47, -49,
 -50, -52, -53, -55, -56, -58, -60, -61, -63, -64, -66, -67, -69, -70, -72, -74,
 -75, -77, -78, -80, -81, -83, -84, -86, -88, -89, -91, -92, -94, -95, -97, -98,
 -100, -101, -103, -105, -106, -108, -109, -111, -112, -114, -115, -117, -118, -120, -121, -123,
 -124, -126, -127, -129, -130, -132, -134, -135, -137, -138, -140, -141, -143, -144, -146, -147,
 -149, -150, -152, -153, -155, -156, -158, -159, -161, -162, -164, -165, -167, -168, -170, -171,
 -172, -174, -175, -177, -178, -180, -181, -183, -184, -186, -187, -189, -190, -192, -193, -194,
 -196, -197, -199, -200, -202, -203, -205, -206, -207, -209, -210, -212, -213, -215, -216, -217,
 -219, -220, -222, -223, -225, -226, -227, -229, -230, -232, -233, -234, -236, -237, -239, -240,
 -241, -243, -244, -246, -247, -248, -250, -251, -252, -254, -255, -256, -258, -259, -261, -262,
 -263, -265, -266, -267, -269, -270, -271, -273, -274, -275, -277, -278, -279, -281, -282, -283,
 -284, -286, -287, -288, -290, -291, -292, -294, -295, -296, -297, -299, -300, -301, -302, -304,
 -305, -306, -308, -309, -310, -311, -313, -314, -315, -316, -317, -319, -320, -321, -322, -324,
 -325, -326, -327, -328, -330, -331, -332, -333, -334, -336, -337, -338, -339, -340, -342, -343,
 -344, -345, -346, -347, -348, -350, -351, -352, -353, -354, -355, -356, -358, -359, -360, -361,
 -362, -363, -364, -365, -366, -368, -369, -370, -371, -372, -373, -374, -375, -376, -377, -378,
 -379, -380, -381, -383, -384, -385, -386, -387, -388, -389, -390, -391, -392, -393, -394, -395,
 -396, -397, -398, -399, -400, -401, -402, -403, -404, -405, -406, -407, -407, -408, -409, -410,
 -411, -412, -413, -414, -415, -416, -417, -418, -419, -420, -420, -421, -422, -423, -424, -425,
 -426, -427, -427, -428, -429, -430, -431, -432, -433, -433, -434, -435, -436, -437, -438, -438,
 -439, -440, -441, -442, -442, -443, -444, -445, -445, -446, -447, -448, -449, -449, -450, -451,
 -452, -452, -453, -454, -454, -455, -456, -457, -457, -458, -459, -459, -460, -461, -461, -462,
 -463, -464, -464, -465, -465, -466, -467, -467, -468, -469, -469, -470, -471, -471, -472, -472,
 -473, -474, -474, -475, -475, -476, -477, -477, -478, -478, -479, -479, -480, -480, -481, -482,
 -482, -483, -483, -484, -484, -485, -485, -486, -486, -487, -487, -488, -488, -489, -489, -489,
 -490, -490, -491, -491, -492, -492, -493, -493, -493, -494, -494, -495, -495, -495, -496, -496,
 -497, -497, -497, -498, -498, -499, -499, -499, -500, -500, -500, -501, -501, -501, -502, -502,
 -502, -502, -503, -503, -503, -504, -504, -504, -504, -505, -505, -505, -505, -506, -506, -506,
 -506, -507, -507, -507, -507, -508, -508, -508, -508, -508, -509, -509, -509, -509, -509, -509,
 -510, -510, -510, -510, -510, -510, -510, -510, -511, -511, -511, -511, -511, -511, -511, -511,
 -511, -511, -512, -512, -512, -512, -512, -512, -512, -512, -512, -512, -512, -512, -512, -512,
 -512
};
#endif

