/****************************************************************
*
* Filename:	commontable.c
*
* Function:	The fixed realize of math functions.
*
* Author:	
*			Witten.Wen		2008-06-18
*
* Copyrights: 
*
*		VisualOn SoftWare Co., Ltd. All Rights are reserved
*
*
*
*
**************************************************************/
#include "msaudiodec.h"
#include "commontables.h"
#include "fex.h"


/*	for(i=0; i<256; i++)
		log2_256_table[i] = (int)(log10(1.0+i/256.0)/log10(2.0) * (1<<16)+0.5);*/
VO_U16 log2_256_table[256] = 
{
 0x0, 0x171, 0x2e0, 0x44e, 0x5ba, 0x725, 0x88e, 0x9f7, 0xb5d, 0xcc3, 0xe27, 0xf8a, 0x10eb, 0x124b, 0x13aa, 0x1508,
 0x1664, 0x17bf, 0x1919, 0x1a71, 0x1bc8, 0x1d1e, 0x1e73, 0x1fc6, 0x2119, 0x226a, 0x23ba, 0x2508, 0x2656, 0x27a2, 0x28ed, 0x2a37,
 0x2b80, 0x2cc8, 0x2e0f, 0x2f54, 0x3098, 0x31dc, 0x331e, 0x345f, 0x359f, 0x36de, 0x381b, 0x3958, 0x3a94, 0x3bce, 0x3d08, 0x3e41,
 0x3f78, 0x40af, 0x41e4, 0x4319, 0x444c, 0x457f, 0x46b0, 0x47e1, 0x4910, 0x4a3f, 0x4b6c, 0x4c99, 0x4dc5, 0x4eef, 0x5019, 0x5142,
 0x526a, 0x5391, 0x54b7, 0x55dc, 0x5700, 0x5824, 0x5946, 0x5a68, 0x5b89, 0x5ca8, 0x5dc7, 0x5ee5, 0x6003, 0x611f, 0x623a, 0x6355,
 0x646f, 0x6588, 0x66a0, 0x67b7, 0x68ce, 0x69e4, 0x6af8, 0x6c0c, 0x6d20, 0x6e32, 0x6f44, 0x7055, 0x7165, 0x7274, 0x7383, 0x7490,
 0x759d, 0x76aa, 0x77b5, 0x78c0, 0x79ca, 0x7ad3, 0x7bdb, 0x7ce3, 0x7dea, 0x7ef0, 0x7ff6, 0x80fb, 0x81ff, 0x8302, 0x8405, 0x8507,
 0x8608, 0x8709, 0x8809, 0x8908, 0x8a06, 0x8b04, 0x8c01, 0x8cfe, 0x8dfa, 0x8ef5, 0x8fef, 0x90e9, 0x91e2, 0x92db, 0x93d2, 0x94ca,
 0x95c0, 0x96b6, 0x97ab, 0x98a0, 0x9994, 0x9a87, 0x9b7a, 0x9c6c, 0x9d5e, 0x9e4f, 0x9f3f, 0xa02e, 0xa11e, 0xa20c, 0xa2fa, 0xa3e7,
 0xa4d4, 0xa5c0, 0xa6ab, 0xa796, 0xa881, 0xa96a, 0xaa53, 0xab3c, 0xac24, 0xad0c, 0xadf2, 0xaed9, 0xafbe, 0xb0a4, 0xb188, 0xb26c,
 0xb350, 0xb433, 0xb515, 0xb5f7, 0xb6d9, 0xb7ba, 0xb89a, 0xb97a, 0xba59, 0xbb38, 0xbc16, 0xbcf4, 0xbdd1, 0xbead, 0xbf8a, 0xc065,
 0xc140, 0xc21b, 0xc2f5, 0xc3cf, 0xc4a8, 0xc580, 0xc658, 0xc730, 0xc807, 0xc8de, 0xc9b4, 0xca8a, 0xcb5f, 0xcc34, 0xcd08, 0xcddc,
 0xceaf, 0xcf82, 0xd054, 0xd126, 0xd1f7, 0xd2c8, 0xd399, 0xd469, 0xd538, 0xd607, 0xd6d6, 0xd7a4, 0xd872, 0xd93f, 0xda0c, 0xdad9,
 0xdba5, 0xdc70, 0xdd3b, 0xde06, 0xded0, 0xdf9a, 0xe063, 0xe12c, 0xe1f5, 0xe2bd, 0xe385, 0xe44c, 0xe513, 0xe5d9, 0xe69f, 0xe765,
 0xe82a, 0xe8ef, 0xe9b3, 0xea77, 0xeb3b, 0xebfe, 0xecc1, 0xed83, 0xee45, 0xef06, 0xefc8, 0xf088, 0xf149, 0xf209, 0xf2c8, 0xf387,
 0xf446, 0xf505, 0xf5c3, 0xf680, 0xf73e, 0xf7fb, 0xf8b7, 0xf973, 0xfa2f, 0xfaea, 0xfba5, 0xfc60, 0xfd1a, 0xfdd4, 0xfe8e, 0xff47,
};

static __inline int lookup_log2_positive(VO_U32 x)
{
	VO_U32 xx = 0;
	if(x >= 512)
	{
		while(x >= 512)
		{
			x >>= 1;
			xx++;
		}
		return ((xx<<16) + log2_256_table[x-256]);
	}
	else
		return (int)(log2_256_table[x-256]);
}

static __inline int lookup_log2_negative(VO_U32 x)
{
	VO_U32 xx = (0x10000+(x>>1))/x;
	return -lookup_log2_positive(xx);
}

int voWMAlog2(VO_U32 x)
{
	if(x >= 256)
		return lookup_log2_positive(x);
	else
		return lookup_log2_negative(x);
}

int voWMAlog(VO_U32 x)
{
//	return imuldiv16(voWMAlog2(x), 0xb172);		//0xb172 = (int)(log(2.0)*(1<<16)+0.5)
	return MULTI32(voWMAlog2(x), 0xb17217f8);	//0xb17217f8 = (VO_U32)(log(2.0)*(1<<32) + 0.5)
}

int voWMAlog10(VO_U32 x)
{
//	return imuldiv16(voWMAlog2(x), 0x4d10);		//0x4d10 = (int)(log10(2.0)*(1<<16)+0.5)
	return MULTI32(voWMAlog2(x), 0x4d104d42);	//0x4d104d42 = (VO_U32)(log10(2.0)*(1<<32)+0.5)
}
#if 1
U32 g_pow2LUT[FEX_P2LUT_SIZE] =
{
	0x40000000,	0x400b1800,	0x40163200,	0x40214e00,	0x402c6c00,	0x40378b80,	0x4042ad80,	0x404dd100,
	0x4058f680,	0x40641e00,	0x406f4780,	0x407a7300,	0x4085a080,	0x4090cf80,	0x409c0100,	0x40a73400,
	0x40b26900,	0x40bda000,	0x40c8d900,	0x40d41400,	0x40df5080,	0x40ea8f80,	0x40f5d080,	0x41011300,
	0x410c5780,	0x41179e00,	0x4122e700,	0x412e3180,	0x41397e00,	0x4144cc00,	0x41501c80,	0x415b6f00,
	0x4166c380,	0x41721980,	0x417d7200,	0x4188cc00,	0x41942800,	0x419f8680,	0x41aae680,	0x41b64880,
	0x41c1ac80,	0x41cd1280,	0x41d87a80,	0x41e3e480,	0x41ef5080,	0x41fabe80,	0x42062e80,	0x4211a080,
	0x421d1480,	0x42288a80,	0x42340200,	0x423f7c00,	0x424af800,	0x42567580,	0x4261f580,	0x426d7780,
	0x4278fb00,	0x42848100,	0x42900900,	0x429b9280,	0x42a71e80,	0x42b2ac00,	0x42be3c00,	0x42c9ce00,
	0x42d56180,	0x42e0f780,	0x42ec8f80,	0x42f82900,	0x4303c500,	0x430f6300,	0x431b0300,	0x4326a500,
	0x43324880,	0x433dee80,	0x43499680,	0x43554080,	0x4360ec80,	0x436c9a80,	0x43784a80,	0x4383fc80,
	0x438fb100,	0x439b6700,	0x43a71f00,	0x43b2d980,	0x43be9580,	0x43ca5400,	0x43d61400,	0x43e1d680,
	0x43ed9a80,	0x43f96100,	0x44052980,	0x4410f400,	0x441cc080,	0x44288f00,	0x44346000,	0x44403280,
	0x444c0780,	0x4457de00,	0x4463b700,	0x446f9180,	0x447b6e80,	0x44874d80,	0x44932e80,	0x449f1200,
	0x44aaf700,	0x44b6de00,	0x44c2c780,	0x44ceb300,	0x44daa080,	0x44e69000,	0x44f28180,	0x44fe7500,
	0x450a6a80,	0x45166280,	0x45225c80,	0x452e5880,	0x453a5680,	0x45465680,	0x45525880,	0x455e5d00,
	0x456a6300,	0x45766b80,	0x45827600,	0x458e8280,	0x459a9180,	0x45a6a200,	0x45b2b500,	0x45beca00,
	0x45cae100,	0x45d6fa00,	0x45e31580,	0x45ef3280,	0x45fb5200,	0x46077380,	0x46139780,	0x461fbd00,
	0x462be500,	0x46380f00,	0x46443b00,	0x46506900,	0x465c9980,	0x4668cc00,	0x46750080,	0x46813700,
	0x468d6f80,	0x4699aa80,	0x46a5e780,	0x46b22680,	0x46be6800,	0x46caab00,	0x46d6f080,	0x46e33880,
	0x46ef8200,	0x46fbce00,	0x47081c00,	0x47146c00,	0x4720be80,	0x472d1280,	0x47396980,	0x4745c200,
	0x47521d00,	0x475e7980,	0x476ad900,	0x47773a00,	0x47839d80,	0x47900300,	0x479c6a80,	0x47a8d480,
	0x47b54080,	0x47c1ae80,	0x47ce1f00,	0x47da9180,	0x47e70600,	0x47f37d00,	0x47fff600,	0x480c7100,
	0x4818ee00,	0x48256d80,	0x4831ef00,	0x483e7300,	0x484af900,	0x48578100,	0x48640b00,	0x48709780,
	0x487d2680,	0x4889b700,	0x48964a00,	0x48a2df00,	0x48af7680,	0x48bc1000,	0x48c8ac00,	0x48d54980,
	0x48e1e980,	0x48ee8c00,	0x48fb3080,	0x4907d700,	0x49148000,	0x49212b00,	0x492dd800,	0x493a8780,
	0x49473900,	0x4953ed00,	0x4960a300,	0x496d5b80,	0x497a1600,	0x4986d280,	0x49939180,	0x49a05280,
	0x49ad1580,	0x49b9db00,	0x49c6a300,	0x49d36c80,	0x49e03900,	0x49ed0700,	0x49f9d780,	0x4a06aa80,
	0x4a137f80,	0x4a205700,	0x4a2d3000,	0x4a3a0c00,	0x4a46ea00,	0x4a53ca00,	0x4a60ac80,	0x4a6d9100,
	0x4a7a7800,	0x4a876100,	0x4a944c00,	0x4aa13a00,	0x4aae2980,	0x4abb1b80,	0x4ac81000,	0x4ad50680,
	0x4ae1ff80,	0x4aeefa80,	0x4afbf780,	0x4b08f700,	0x4b15f900,	0x4b22fd00,	0x4b300300,	0x4b3d0c00,
	0x4b4a1680,	0x4b572380,	0x4b643300,	0x4b714480,	0x4b7e5880,	0x4b8b6e80,	0x4b988700,	0x4ba5a180,
	0x4bb2be80,	0x4bbfde00,	0x4bccff80,	0x4bda2300,	0x4be74900,	0x4bf47180,	0x4c019c00,	0x4c0ec900,
	0x4c1bf800,	0x4c292980,	0x4c365d80,	0x4c439380,	0x4c50cb80,	0x4c5e0680,	0x4c6b4300,	0x4c788280,
	0x4c85c400,	0x4c930780,	0x4ca04e00,	0x4cad9600,	0x4cbae100,	0x4cc82e00,	0x4cd57d00,	0x4ce2cf00,
	0x4cf02300,	0x4cfd7900,	0x4d0ad180,	0x4d182c80,	0x4d258980,	0x4d32e900,	0x4d404b00,	0x4d4daf00,
	0x4d5b1580,	0x4d687e80,	0x4d75e980,	0x4d835700,	0x4d90c680,	0x4d9e3880,	0x4dabad00,	0x4db92400,
	0x4dc69d00,	0x4dd41880,	0x4de19600,	0x4def1600,	0x4dfc9880,	0x4e0a1d80,	0x4e17a480,	0x4e252e00,
	0x4e32b980,	0x4e404800,	0x4e4dd880,	0x4e5b6b00,	0x4e690080,	0x4e769800,	0x4e843200,	0x4e91ce00,
	0x4e9f6d00,	0x4ead0e00,	0x4ebab100,	0x4ec85700,	0x4ed5ff00,	0x4ee3a980,	0x4ef15680,	0x4eff0580,
	0x4f0cb700,	0x4f1a6b00,	0x4f282180,	0x4f35da00,	0x4f439500,	0x4f515280,	0x4f5f1280,	0x4f6cd480,
	0x4f7a9900,	0x4f886000,	0x4f962980,	0x4fa3f580,	0x4fb1c380,	0x4fbf9400,	0x4fcd6700,	0x4fdb3c80,
	0x4fe91400,	0x4ff6ee00,	0x5004cb00,	0x5012a980,	0x50208b00,	0x502e6f00,	0x503c5500,	0x504a3d80,
	0x50582880,	0x50661600,	0x50740580,	0x5081f800,	0x508fec80,	0x509de380,	0x50abdd00,	0x50b9d900,
	0x50c7d780,	0x50d5d800,	0x50e3db80,	0x50f1e100,	0x50ffe900,	0x510df380,	0x511c0080,	0x512a0f80,
	0x51382180,	0x51463580,	0x51544c80,	0x51626580,	0x51708100,	0x517e9f00,	0x518cbf80,	0x519ae280,
	0x51a90780,	0x51b72f80,	0x51c55980,	0x51d38680,	0x51e1b580,	0x51efe700,	0x51fe1b80,	0x520c5200,
	0x521a8b00,	0x5228c680,	0x52370400,	0x52454480,	0x52538780,	0x5261cd00,	0x52701480,	0x527e5f00,
	0x528cac00,	0x529afb00,	0x52a94c80,	0x52b7a100,	0x52c5f780,	0x52d45100,	0x52e2ac80,	0x52f10a80,
	0x52ff6b80,	0x530dce80,	0x531c3400,	0x532a9c00,	0x53390700,	0x53477400,	0x5355e380,	0x53645600,
	0x5372ca80,	0x53814180,	0x538fbb00,	0x539e3780,	0x53acb600,	0x53bb3700,	0x53c9bb00,	0x53d84100,
	0x53e6ca00,	0x53f55500,	0x5403e300,	0x54127300,	0x54210600,	0x542f9b80,	0x543e3300,	0x544ccd80,
	0x545b6a80,	0x546a0a00,	0x5478ac00,	0x54875080,	0x5495f780,	0x54a4a100,	0x54b34d80,	0x54c1fc00,
	0x54d0ad80,	0x54df6100,	0x54ee1780,	0x54fcd080,	0x550b8c00,	0x551a4a00,	0x55290a80,	0x5537cd80,
	0x55469300,	0x55555b80,	0x55642600,	0x5572f380,	0x5581c380,	0x55909600,	0x559f6b00,	0x55ae4280,
	0x55bd1d00,	0x55cbf980,	0x55dad900,	0x55e9bb00,	0x55f89f80,	0x56078680,	0x56167000,	0x56255c80,
	0x56344b80,	0x56433d00,	0x56523100,	0x56612780,	0x56702080,	0x567f1c80,	0x568e1b00,	0x569d1c00,
	0x56ac1f80,	0x56bb2580,	0x56ca2e80,	0x56d93a00,	0x56e84800,	0x56f75880,	0x57066c00,	0x57158180,
	0x57249a00,	0x5733b580,	0x5742d300,	0x5751f380,	0x57611680,	0x57703c00,	0x577f6400,	0x578e8f00,
	0x579dbc80,	0x57acec80,	0x57bc1f00,	0x57cb5480,	0x57da8c80,	0x57e9c700,	0x57f90480,	0x58084480,
	0x58178700,	0x5826cc00,	0x58361400,	0x58455e80,	0x5854ab80,	0x5863fb80,	0x58734e00,	0x5882a300,
	0x5891fb00,	0x58a15500,	0x58b0b280,	0x58c01200,	0x58cf7480,	0x58ded980,	0x58ee4180,	0x58fdab80,
	0x590d1900,	0x591c8880,	0x592bfb00,	0x593b7000,	0x594ae800,	0x595a6280,	0x5969df80,	0x59795f80,
	0x5988e200,	0x59986780,	0x59a7ef00,	0x59b77a00,	0x59c70700,	0x59d69700,	0x59e62a00,	0x59f5bf00,
	0x5a055780,	0x5a14f200,	0x5a248f80,	0x5a343000,	0x5a43d300,	0x5a537880,	0x5a632100,	0x5a72cc00,
	0x5a827980,	0x5a922a00,	0x5aa1dd80,	0x5ab19380,	0x5ac14c00,	0x5ad10780,	0x5ae0c580,	0x5af08680,
	0x5b004a00,	0x5b101000,	0x5b1fd900,	0x5b2fa500,	0x5b3f7380,	0x5b4f4480,	0x5b5f1880,	0x5b6eef80,
	0x5b7ec900,	0x5b8ea500,	0x5b9e8400,	0x5bae6600,	0x5bbe4a80,	0x5bce3180,	0x5bde1b80,	0x5bee0880,
	0x5bfdf800,	0x5c0dea00,	0x5c1ddf00,	0x5c2dd700,	0x5c3dd180,	0x5c4dcf00,	0x5c5dcf00,	0x5c6dd200,
	0x5c7dd780,	0x5c8de000,	0x5c9deb80,	0x5cadf980,	0x5cbe0a00,	0x5cce1d80,	0x5cde3400,	0x5cee4d00,
	0x5cfe6900,	0x5d0e8800,	0x5d1ea980,	0x5d2ecd80,	0x5d3ef500,	0x5d4f1f00,	0x5d5f4b80,	0x5d6f7b00,
	0x5d7fad80,	0x5d8fe280,	0x5da01a80,	0x5db05500,	0x5dc09300,	0x5dd0d300,	0x5de11680,	0x5df15c80,
	0x5e01a500,	0x5e11f100,	0x5e223f80,	0x5e329080,	0x5e42e500,	0x5e533c00,	0x5e639580,	0x5e73f280,
	0x5e845200,	0x5e94b400,	0x5ea51980,	0x5eb58180,	0x5ec5ec00,	0x5ed65a00,	0x5ee6ca80,	0x5ef73e00,
	0x5f07b400,	0x5f182d00,	0x5f28a900,	0x5f392800,	0x5f49a980,	0x5f5a2e00,	0x5f6ab580,	0x5f7b3f80,
	0x5f8bcd00,	0x5f9c5d00,	0x5facef80,	0x5fbd8580,	0x5fce1e00,	0x5fdeb980,	0x5fef5800,	0x5ffff900,
	0x60109d80,	0x60214480,	0x6031ee00,	0x60429b00,	0x60534a80,	0x6063fd80,	0x6074b300,	0x60856b00,
	0x60962680,	0x60a6e480,	0x60b7a580,	0x60c86980,	0x60d93080,	0x60e9fa80,	0x60fac700,	0x610b9680,
	0x611c6900,	0x612d3e80,	0x613e1700,	0x614ef200,	0x615fd080,	0x6170b180,	0x61819580,	0x61927c80,
	0x61a36680,	0x61b45380,	0x61c54300,	0x61d63580,	0x61e72b80,	0x61f82400,	0x62091f80,	0x621a1e00,
	0x622b1f80,	0x623c2400,	0x624d2b00,	0x625e3580,	0x626f4280,	0x62805280,	0x62916600,	0x62a27c00,
	0x62b39500,	0x62c4b100,	0x62d5d000,	0x62e6f200,	0x62f81700,	0x63093f00,	0x631a6980,	0x632b9780,
	0x633cc880,	0x634dfc00,	0x635f3300,	0x63706c80,	0x6381a980,	0x6392e900,	0x63a42c00,	0x63b57180,
	0x63c6ba80,	0x63d80600,	0x63e95500,	0x63faa680,	0x640bfb80,	0x641d5300,	0x642ead80,	0x64400b80,
	0x64516c00,	0x6462d000,	0x64743680,	0x6485a080,	0x64970d80,	0x64a87d00,	0x64b9f000,	0x64cb6600,
	0x64dcdf00,	0x64ee5a80,	0x64ffd980,	0x65115b80,	0x6522e080,	0x65346880,	0x6545f400,	0x65578200,
	0x65691300,	0x657aa780,	0x658c3e80,	0x659dd900,	0x65af7680,	0x65c11700,	0x65d2ba80,	0x65e46100,
	0x65f60a80,	0x6607b700,	0x66196700,	0x662b1980,	0x663ccf80,	0x664e8880,	0x66604480,	0x66720380,
	0x6683c600,	0x66958b00,	0x66a75380,	0x66b91e80,	0x66caed00,	0x66dcbf00,	0x66ee9380,	0x67006b00,
	0x67124600,	0x67242400,	0x67360500,	0x6747e900,	0x6759d080,	0x676bba80,	0x677da800,	0x678f9880,
	0x67a18c80,	0x67b38300,	0x67c57d00,	0x67d77a00,	0x67e97a00,	0x67fb7d80,	0x680d8400,	0x681f8d80,
	0x68319a00,	0x6843a980,	0x6855bc80,	0x6867d280,	0x6879eb80,	0x688c0800,	0x689e2780,	0x68b04a00,
	0x68c26f80,	0x68d49880,	0x68e6c480,	0x68f8f380,	0x690b2600,	0x691d5b80,	0x692f9400,	0x6941d000,
	0x69540f00,	0x69665100,	0x69789600,	0x698ade80,	0x699d2a00,	0x69af7900,	0x69c1cb00,	0x69d42000,
	0x69e67880,	0x69f8d400,	0x6a0b3280,	0x6a1d9480,	0x6a2ff980,	0x6a426180,	0x6a54cd00,	0x6a673b80,
	0x6a79ad80,	0x6a8c2280,	0x6a9e9a80,	0x6ab11600,	0x6ac39480,	0x6ad61680,	0x6ae89b80,	0x6afb2380,
	0x6b0daf00,	0x6b203d80,	0x6b32cf80,	0x6b456480,	0x6b57fd00,	0x6b6a9880,	0x6b7d3700,	0x6b8fd900,
	0x6ba27e80,	0x6bb52700,	0x6bc7d280,	0x6bda8180,	0x6bed3380,	0x6bffe900,	0x6c12a180,	0x6c255d80,
	0x6c381c80,	0x6c4adf00,	0x6c5da480,	0x6c706d80,	0x6c833980,	0x6c960900,	0x6ca8dc00,	0x6cbbb180,
	0x6cce8b00,	0x6ce16780,	0x6cf44700,	0x6d072a00,	0x6d1a1080,	0x6d2cfa00,	0x6d3fe680,	0x6d52d700,
	0x6d65ca00,	0x6d78c100,	0x6d8bbb00,	0x6d9eb800,	0x6db1b880,	0x6dc4bc80,	0x6dd7c380,	0x6deace00,
	0x6dfddc00,	0x6e10ed00,	0x6e240100,	0x6e371900,	0x6e4a3400,	0x6e5d5200,	0x6e707380,	0x6e839880,
	0x6e96c100,	0x6ea9ec80,	0x6ebd1b00,	0x6ed04d80,	0x6ee38300,	0x6ef6bb80,	0x6f09f800,	0x6f1d3780,
	0x6f307a80,	0x6f43c080,	0x6f570a00,	0x6f6a5700,	0x6f7da700,	0x6f90fa80,	0x6fa45180,	0x6fb7ac00,
	0x6fcb0980,	0x6fde6a80,	0x6ff1cf00,	0x70053680,	0x7018a180,	0x702c1000,	0x703f8180,	0x7052f700,
	0x70666f80,	0x7079eb80,	0x708d6a80,	0x70a0ed80,	0x70b47380,	0x70c7fd00,	0x70db8980,	0x70ef1a00,
	0x7102ad80,	0x71164480,	0x7129df00,	0x713d7c80,	0x71511e00,	0x7164c280,	0x71786a80,	0x718c1600,
	0x719fc480,	0x71b37700,	0x71c72c80,	0x71dae580,	0x71eea200,	0x72026200,	0x72162580,	0x7229ec00,
	0x723db680,	0x72518400,	0x72655500,	0x72792980,	0x728d0180,	0x72a0dc80,	0x72b4bb80,	0x72c89e00,
	0x72dc8380,	0x72f06c80,	0x73045900,	0x73184900,	0x732c3c80,	0x73403380,	0x73542e00,	0x73682c00,
	0x737c2d80,	0x73903200,	0x73a43a80,	0x73b84600,	0x73cc5580,	0x73e06800,	0x73f47e80,	0x74089800,
	0x741cb500,	0x7430d600,	0x7444fa00,	0x74592180,	0x746d4c80,	0x74817b80,	0x7495ad80,	0x74a9e300,
	0x74be1c00,	0x74d25880,	0x74e69900,	0x74fadc80,	0x750f2380,	0x75236e80,	0x7537bc80,	0x754c0e00,
	0x75606380,	0x7574bc00,	0x75891880,	0x759d7880,	0x75b1db80,	0x75c64280,	0x75daad00,	0x75ef1b00,
	0x76038c80,	0x76180180,	0x762c7a00,	0x7640f600,	0x76557600,	0x7669f900,	0x767e8000,	0x76930a00,
	0x76a79800,	0x76bc2980,	0x76d0be80,	0x76e55700,	0x76f9f380,	0x770e9300,	0x77233680,	0x7737dd80,
	0x774c8800,	0x77613600,	0x7775e780,	0x778a9c80,	0x779f5580,	0x77b41200,	0x77c8d200,	0x77dd9580,
	0x77f25d00,	0x78072780,	0x781bf600,	0x7830c800,	0x78459d80,	0x785a7700,	0x786f5400,	0x78843400,
	0x78991880,	0x78ae0000,	0x78c2eb80,	0x78d7da80,	0x78eccd00,	0x7901c300,	0x7916bd00,	0x792bba80,
	0x7940bb80,	0x7955c080,	0x796ac900,	0x797fd500,	0x7994e480,	0x79a9f800,	0x79bf0f00,	0x79d42980,
	0x79e94800,	0x79fe6a00,	0x7a138f80,	0x7a28b900,	0x7a3de600,	0x7a531680,	0x7a684b00,	0x7a7d8300,
	0x7a92be80,	0x7aa7fe00,	0x7abd4100,	0x7ad28780,	0x7ae7d200,	0x7afd2000,	0x7b127200,	0x7b27c780,
	0x7b3d2080,	0x7b527d80,	0x7b67de00,	0x7b7d4280,	0x7b92aa80,	0x7ba81680,	0x7bbd8580,	0x7bd2f900,
	0x7be86f80,	0x7bfdea80,	0x7c136880,	0x7c28ea80,	0x7c3e7080,	0x7c53fa00,	0x7c698700,	0x7c7f1800,
	0x7c94ad00,	0x7caa4580,	0x7cbfe180,	0x7cd58180,	0x7ceb2500,	0x7d00cc80,	0x7d167800,	0x7d2c2680,
	0x7d41d980,	0x7d579000,	0x7d6d4a00,	0x7d830800,	0x7d98ca00,	0x7dae8f80,	0x7dc45900,	0x7dda2600,
	0x7deff680,	0x7e05cb80,	0x7e1ba400,	0x7e318000,	0x7e476000,	0x7e5d4400,	0x7e732b80,	0x7e891700,
	0x7e9f0600,	0x7eb4f900,	0x7ecaf000,	0x7ee0ea80,	0x7ef6e900,	0x7f0ceb00,	0x7f22f100,	0x7f38fb00,
	0x7f4f0880,	0x7f651a00,	0x7f7b2f80,	0x7f914880,	0x7fa76580,	0x7fbd8680,	0x7fd3ab00,	0x7fe9d380,
};
#endif
/*
Magnify 0x8000
#define FIXED 0x8000
for(i=0; i<256; i++)
	{
		pow2_256[i] = (int)(pow((long double)2.0, (long double)(i/256.0))*FIXED);
	}
*/
VO_U16 pow2_256[256] = 
{
		0x8000,		0x8058,		0x80b1,		0x810b,		0x8164,		0x81be,		0x8218,		0x8272,
		0x82cd,		0x8328,		0x8383,		0x83de,		0x843a,		0x8495,		0x84f1,		0x854e,
		0x85aa,		0x8607,		0x8664,		0x86c1,		0x871f,		0x877d,		0x87db,		0x8839,
		0x8898,		0x88f6,		0x8955,		0x89b5,		0x8a14,		0x8a74,		0x8ad4,		0x8b35,
		0x8b95,		0x8bf6,		0x8c57,		0x8cb9,		0x8d1a,		0x8d7c,		0x8ddf,		0x8e41,
		0x8ea4,		0x8f07,		0x8f6a,		0x8fce,		0x9031,		0x9095,		0x90fa,		0x915e,
		0x91c3,		0x9228,		0x928e,		0x92f4,		0x935a,		0x93c0,		0x9426,		0x948d,
		0x94f4,		0x955c,		0x95c3,		0x962b,		0x9694,		0x96fc,		0x9765,		0x97ce,
		0x9837,		0x98a1,		0x990b,		0x9975,		0x99e0,		0x9a4b,		0x9ab6,		0x9b21,
		0x9b8d,		0x9bf9,		0x9c65,		0x9cd2,		0x9d3e,		0x9dab,		0x9e19,		0x9e87,
		0x9ef5,		0x9f63,		0x9fd2,		0xa041,		0xa0b0,		0xa11f,		0xa18f,		0xa1ff,
		0xa270,		0xa2e1,		0xa352,		0xa3c3,		0xa435,		0xa4a7,		0xa519,		0xa58b,
		0xa5fe,		0xa672,		0xa6e5,		0xa759,		0xa7cd,		0xa842,		0xa8b6,		0xa92b,
		0xa9a1,		0xaa17,		0xaa8d,		0xab03,		0xab7a,		0xabf1,		0xac68,		0xace0,
		0xad58,		0xadd0,		0xae49,		0xaec2,		0xaf3b,		0xafb5,		0xb02f,		0xb0a9,
		0xb123,		0xb19e,		0xb21a,		0xb295,		0xb311,		0xb38e,		0xb40a,		0xb487,
		0xb504,		0xb582,		0xb600,		0xb67e,		0xb6fd,		0xb77c,		0xb7fb,		0xb87b,
		0xb8fb,		0xb97c,		0xb9fc,		0xba7d,		0xbaff,		0xbb81,		0xbc03,		0xbc85,
		0xbd08,		0xbd8b,		0xbe0f,		0xbe93,		0xbf17,		0xbf9c,		0xc021,		0xc0a6,
		0xc12c,		0xc1b2,		0xc238,		0xc2bf,		0xc346,		0xc3ce,		0xc456,		0xc4de,
		0xc567,		0xc5f0,		0xc679,		0xc703,		0xc78d,		0xc817,		0xc8a2,		0xc92e,
		0xc9b9,		0xca45,		0xcad2,		0xcb5e,		0xcbec,		0xcc79,		0xcd07,		0xcd95,
		0xce24,		0xceb3,		0xcf43,		0xcfd2,		0xd063,		0xd0f3,		0xd184,		0xd216,
		0xd2a8,		0xd33a,		0xd3cc,		0xd45f,		0xd4f3,		0xd587,		0xd61b,		0xd6af,
		0xd744,		0xd7da,		0xd870,		0xd906,		0xd99d,		0xda34,		0xdacb,		0xdb63,
		0xdbfb,		0xdc94,		0xdd2d,		0xddc7,		0xde60,		0xdefb,		0xdf96,		0xe031,
		0xe0cc,		0xe168,		0xe205,		0xe2a2,		0xe33f,		0xe3dd,		0xe47b,		0xe51a,
		0xe5b9,		0xe658,		0xe6f8,		0xe798,		0xe839,		0xe8da,		0xe97c,		0xea1e,
		0xeac0,		0xeb63,		0xec07,		0xecaa,		0xed4f,		0xedf3,		0xee99,		0xef3e,
		0xefe4,		0xf08b,		0xf132,		0xf1d9,		0xf281,		0xf329,		0xf3d2,		0xf47b,
		0xf525,		0xf5cf,		0xf67a,		0xf725,		0xf7d0,		0xf87c,		0xf929,		0xf9d6,
		0xfa83,		0xfb31,		0xfbdf,		0xfc8e,		0xfd3e,		0xfded,		0xfe9e,		0xff4e,
};
/*real parameter should be magnify 256*/
double voWMAPow2(int x)
{
	int x_integer, x_fraction;
	x_integer = x>>8;
	x_fraction = x & 0xff;	//x - (x_integer<<8);
	if(x_integer>=POWSHIFTBITS)
		return (double)((int)pow2_256[x_fraction]<<(x_integer-POWSHIFTBITS));
	if(x_integer>=0)
		return ((double)((int)pow2_256[x_fraction]<<x_integer)/32768.0);
	else
	{
		x_integer *= -1;
		return (double)((int)pow2_256[x_fraction]>>x_integer)/32768.0;
	}
}

int voWMACeil(double x)
{
	double y = x;
	return(x>0&&y!=(double)((int)x)) ? (int)(x+1) : (int)(x);
}


/*	for(i=128; i<512; i++)
		sqrt512[i-128] = (int)(sqrt((double)i/512)*(1<<16)+0.5);
*/
VO_U16 sqrt512[384] = 
{
 0x8000, 0x8080, 0x80ff, 0x817e, 0x81fc, 0x827a, 0x82f7, 0x8374, 0x83f0, 0x846c, 0x84e8, 0x8563, 0x85de, 0x8658, 0x86d2, 0x874b,
 0x87c4, 0x883c, 0x88b4, 0x892c, 0x89a3, 0x8a1a, 0x8a90, 0x8b06, 0x8b7c, 0x8bf1, 0x8c66, 0x8cdb, 0x8d4f, 0x8dc3, 0x8e36, 0x8ea9,
 0x8f1c, 0x8f8e, 0x9000, 0x9072, 0x90e3, 0x9154, 0x91c4, 0x9235, 0x92a4, 0x9314, 0x9383, 0x93f2, 0x9461, 0x94cf, 0x953d, 0x95ab,
 0x9618, 0x9685, 0x96f2, 0x975e, 0x97ca, 0x9836, 0x98a1, 0x990d, 0x9977, 0x99e2, 0x9a4c, 0x9ab6, 0x9b20, 0x9b8a, 0x9bf3, 0x9c5c,
 0x9cc4, 0x9d2d, 0x9d95, 0x9dfd, 0x9e64, 0x9ecc, 0x9f33, 0x9f99, 0xa000, 0xa066, 0xa0cc, 0xa132, 0xa198, 0xa1fd, 0xa262, 0xa2c7,
 0xa32b, 0xa38f, 0xa3f4, 0xa457, 0xa4bb, 0xa51e, 0xa581, 0xa5e4, 0xa647, 0xa6a9, 0xa70b, 0xa76d, 0xa7cf, 0xa831, 0xa892, 0xa8f3,
 0xa954, 0xa9b5, 0xaa15, 0xaa75, 0xaad5, 0xab35, 0xab95, 0xabf4, 0xac53, 0xacb2, 0xad11, 0xad70, 0xadce, 0xae2c, 0xae8a, 0xaee8,
 0xaf45, 0xafa3, 0xb000, 0xb05d, 0xb0ba, 0xb116, 0xb173, 0xb1cf, 0xb22b, 0xb287, 0xb2e3, 0xb33e, 0xb399, 0xb3f5, 0xb450, 0xb4aa,
 0xb505, 0xb55f, 0xb5ba, 0xb614, 0xb66e, 0xb6c7, 0xb721, 0xb77a, 0xb7d3, 0xb82d, 0xb885, 0xb8de, 0xb937, 0xb98f, 0xb9e7, 0xba3f,
 0xba97, 0xbaef, 0xbb46, 0xbb9e, 0xbbf5, 0xbc4c, 0xbca3, 0xbcfa, 0xbd51, 0xbda7, 0xbdfd, 0xbe53, 0xbea9, 0xbeff, 0xbf55, 0xbfab,
 0xc000, 0xc055, 0xc0aa, 0xc0ff, 0xc154, 0xc1a9, 0xc1fd, 0xc252, 0xc2a6, 0xc2fa, 0xc34e, 0xc3a2, 0xc3f6, 0xc449, 0xc49c, 0xc4f0,
 0xc543, 0xc596, 0xc5e9, 0xc63b, 0xc68e, 0xc6e0, 0xc733, 0xc785, 0xc7d7, 0xc829, 0xc87b, 0xc8cc, 0xc91e, 0xc96f, 0xc9c1, 0xca12,
 0xca63, 0xcab4, 0xcb04, 0xcb55, 0xcba6, 0xcbf6, 0xcc46, 0xcc96, 0xcce6, 0xcd36, 0xcd86, 0xcdd6, 0xce25, 0xce75, 0xcec4, 0xcf13,
 0xcf62, 0xcfb1, 0xd000, 0xd04f, 0xd09d, 0xd0ec, 0xd13a, 0xd188, 0xd1d7, 0xd225, 0xd272, 0xd2c0, 0xd30e, 0xd35c, 0xd3a9, 0xd3f6,
 0xd444, 0xd491, 0xd4de, 0xd52b, 0xd577, 0xd5c4, 0xd611, 0xd65d, 0xd6aa, 0xd6f6, 0xd742, 0xd78e, 0xd7da, 0xd826, 0xd872, 0xd8bd,
 0xd909, 0xd954, 0xd9a0, 0xd9eb, 0xda36, 0xda81, 0xdacc, 0xdb17, 0xdb62, 0xdbac, 0xdbf7, 0xdc41, 0xdc8b, 0xdcd6, 0xdd20, 0xdd6a,
 0xddb4, 0xddfe, 0xde47, 0xde91, 0xdedb, 0xdf24, 0xdf6e, 0xdfb7, 0xe000, 0xe049, 0xe092, 0xe0db, 0xe124, 0xe16d, 0xe1b5, 0xe1fe,
 0xe246, 0xe28f, 0xe2d7, 0xe31f, 0xe367, 0xe3af, 0xe3f7, 0xe43f, 0xe487, 0xe4ce, 0xe516, 0xe55d, 0xe5a5, 0xe5ec, 0xe633, 0xe67a,
 0xe6c1, 0xe708, 0xe74f, 0xe796, 0xe7dd, 0xe823, 0xe86a, 0xe8b0, 0xe8f7, 0xe93d, 0xe983, 0xe9c9, 0xea0f, 0xea55, 0xea9b, 0xeae1,
 0xeb27, 0xeb6c, 0xebb2, 0xebf7, 0xec3d, 0xec82, 0xecc7, 0xed0c, 0xed51, 0xed96, 0xeddb, 0xee20, 0xee65, 0xeeaa, 0xeeee, 0xef33,
 0xef77, 0xefbc, 0xf000, 0xf044, 0xf088, 0xf0cc, 0xf110, 0xf154, 0xf198, 0xf1dc, 0xf220, 0xf263, 0xf2a7, 0xf2ea, 0xf32e, 0xf371,
 0xf3b4, 0xf3f8, 0xf43b, 0xf47e, 0xf4c1, 0xf504, 0xf546, 0xf589, 0xf5cc, 0xf60f, 0xf651, 0xf694, 0xf6d6, 0xf718, 0xf75b, 0xf79d,
 0xf7df, 0xf821, 0xf863, 0xf8a5, 0xf8e7, 0xf929, 0xf96a, 0xf9ac, 0xf9ee, 0xfa2f, 0xfa71, 0xfab2, 0xfaf3, 0xfb35, 0xfb76, 0xfbb7,
 0xfbf8, 0xfc39, 0xfc7a, 0xfcbb, 0xfcfb, 0xfd3c, 0xfd7d, 0xfdbd, 0xfdfe, 0xfe3e, 0xfe7f, 0xfebf, 0xfeff, 0xff40, 0xff80, 0xffc0,
};
double voWMASqrt512(int x)
{
	VO_S32 xx=0;
	if(x>=128)
	{
		while(x >= 512)
		{
			x >>= 2;
			xx++;
		}
		return (double)(sqrt512[x-128] << xx)/65536.0;
	} else {
		while(x < 128)
		{
			x <<= 2;
			xx++;
		}
		return (double)(sqrt512[x-128] >> xx)/65536.0;
	}
}

/*sin and cos function, Magnifying 0x8000, and need right shift 15 bits, 0x8000 * sin(i * pi / 512), i=0,1,...,256. */
//__declspec(align(4)) VO_U16 sine_table[257] =
VO_U16 sine_table[258] =
{
	0x0,	0xc9,	0x192,	0x25b,	0x324,	0x3ed,	0x4b6,	0x57f,	0x647,	0x710,	0x7d9,	0x8a2,	0x96a,	0xa33,	0xafb,	0xbc3,
	0xc8b,	0xd53,	0xe1b,	0xee3,	0xfab,	0x1072,	0x1139,	0x1201,	0x12c8,	0x138e,	0x1455,	0x151b,	0x15e2,	0x16a8,	0x176d,	0x1833,
	0x18f8,	0x19bd,	0x1a82,	0x1b47,	0x1c0b,	0x1ccf,	0x1d93,	0x1e56,	0x1f19,	0x1fdc,	0x209f,	0x2161,	0x2223,	0x22e5,	0x23a6,	0x2467,
	0x2528,	0x25e8,	0x26a8,	0x2767,	0x2826,	0x28e5,	0x29a3,	0x2a61,	0x2b1f,	0x2bdc,	0x2c98,	0x2d55,	0x2e11,	0x2ecc,	0x2f87,	0x3041,
	0x30fb,	0x31b5,	0x326e,	0x3326,	0x33de,	0x3496,	0x354d,	0x3604,	0x36ba,	0x376f,	0x3824,	0x38d8,	0x398c,	0x3a40,	0x3af2,	0x3ba5,
	0x3c56,	0x3d07,	0x3db8,	0x3e68,	0x3f17,	0x3fc5,	0x4073,	0x4121,	0x41ce,	0x427a,	0x4325,	0x43d0,	0x447a,	0x4524,	0x45cd,	0x4675,
	0x471c,	0x47c3,	0x4869,	0x490f,	0x49b4,	0x4a58,	0x4afb,	0x4b9e,	0x4c3f,	0x4ce1,	0x4d81,	0x4e21,	0x4ebf,	0x4f5e,	0x4ffb,	0x5097,
	0x5133,	0x51ce,	0x5269,	0x5302,	0x539b,	0x5433,	0x54ca,	0x5560,	0x55f5,	0x568a,	0x571d,	0x57b0,	0x5842,	0x58d4,	0x5964,	0x59f3,
	0x5a82,	0x5b10,	0x5b9d,	0x5c29,	0x5cb4,	0x5d3e,	0x5dc7,	0x5e50,	0x5ed7,	0x5f5e,	0x5fe3,	0x6068,	0x60ec,	0x616f,	0x61f1,	0x6271,
	0x62f2,	0x6371,	0x63ef,	0x646c,	0x64e8,	0x6563,	0x65dd,	0x6657,	0x66cf,	0x6746,	0x67bd,	0x6832,	0x68a6,	0x6919,	0x698c,	0x69fd,
	0x6a6d,	0x6adc,	0x6b4a,	0x6bb8,	0x6c24,	0x6c8f,	0x6cf9,	0x6d62,	0x6dca,	0x6e30,	0x6e96,	0x6efb,	0x6f5f,	0x6fc1,	0x7023,	0x7083,
	0x70e2,	0x7141,	0x719e,	0x71fa,	0x7255,	0x72af,	0x7307,	0x735f,	0x73b5,	0x740b,	0x745f,	0x74b2,	0x7504,	0x7555,	0x75a5,	0x75f4,
	0x7641,	0x768e,	0x76d9,	0x7723,	0x776c,	0x77b4,	0x77fa,	0x7840,	0x7884,	0x78c7,	0x7909,	0x794a,	0x798a,	0x79c8,	0x7a05,	0x7a42,
	0x7a7d,	0x7ab6,	0x7aef,	0x7b26,	0x7b5d,	0x7b92,	0x7bc5,	0x7bf8,	0x7c29,	0x7c5a,	0x7c89,	0x7cb7,	0x7ce3,	0x7d0f,	0x7d39,	0x7d62,
	0x7d8a,	0x7db0,	0x7dd6,	0x7dfa,	0x7e1d,	0x7e3f,	0x7e5f,	0x7e7f,	0x7e9d,	0x7eba,	0x7ed5,	0x7ef0,	0x7f09,	0x7f21,	0x7f38,	0x7f4d,
	0x7f62,	0x7f75,	0x7f87,	0x7f97,	0x7fa7,	0x7fb5,	0x7fc2,	0x7fce,	0x7fd8,	0x7fe1,	0x7fe9,	0x7ff0,	0x7ff6,	0x7ffa,	0x7ffd,	0x7fff,
	0x8000, 0x0000
};
/*
   looks up sin(2 * Pi * x / 1024) * 0x8000;
   0x8000 * sin(x) = lookup_sine(x*512/pi)
*/
int lookup_sine(int x)
{
  int xx = x & 0xFF;
  switch ((x>>8) & 0x03)
    {
    default: /* just to shut gcc up. */
    case 0:
      return (int)sine_table[xx];
    case 1:
      return (int)sine_table[0x100 - xx];
    case 2:
      return (int)(-sine_table[xx]);
    case 3:
      return (int)(-sine_table[0x100 - xx]);
    }
}

const int rgrgfltChDnMixMtx6_2[2][6] = 
{
	{0x002978d5,	0x00000000,	0x001d4fdf,	0x002374bc,	0x0015c28f,	0x00000000},
	{0x00000000,	0x002978d5,	0x001d4fdf,	0x0015c28f,	0x002374bc,	0x00000000},	
};

const int rgrgfltChDnMixMtx8_2[2][8] =
{
	{0x001d0e56,	0x00000000,	0x00149ba5,	0x0018d4fe,	0x000f3b64,	0x001a9fbe,	0x000bc6a7,	0x00000000},
	{0x00000000,	0x001d0e56,	0x00149ba5,	0x000f3b64,	0x0018d4fe,	0x000bc6a7,	0x001a9fbe,	0x00000000},
};

const int rgrgfltChDnMixMtx8_6[6][8] = 
{
	{0x00424dd3,	0x00000000,	0x00000000,	0x00000000,	0x00000000,	0x00183126,	0x00000000,	0x00000000},
	{0x00000000,	0x00424dd3,	0x00000000,	0x00000000,	0x00000000,	0x00000000,	0x00183126,	0x00000000},
	{0x00000000,	0x00000000,	0x00424dd3,	0x00000000,	0x00000000,	0x00000000,	0x00000000,	0x00000000},
	{0x00000000,	0x00000000,	0x00000000,	0x00424dd3,	0x00000000,	0x003db22d,	0x00000000,	0x00000000},
	{0x00000000,	0x00000000,	0x00000000,	0x00000000,	0x00424dd3,	0x00000000,	0x003db22d,	0x00000000},
	{0x00000000,	0x00000000,	0x00000000,	0x00000000,	0x00000000,	0x00000000,	0x00000000,	0x00000000},
};

#if !WMA_OPT_VOMEMORY_ARM
void *voWMAMemset(void *pDest, int c, unsigned int size)
{
	char j = c & 0xff;
	unsigned int i = 0;
	char *pD = (char *)pDest;
	for(i =0; i< size; i++)
		pD[i] = j;
	return pDest;
//	return memset(pDest, c, size);
}
void *voWMAMemcpy (void *pDest, const void *pSrc, unsigned int size)
{
	char *pD = (char *)pDest;
	char *pS = (char *)pSrc;
	while(size--)
		*pD++ = *pS++;
	return pDest;
}
#ifndef _WIN32_
I32	MULT_HI_DWORDN_ARM( I32 a, I32 b, I32 N)
{
	return	(I32)((((I64)(a))*((I64)(b)))>>(32-(N)));
}
#endif
#endif

